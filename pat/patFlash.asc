#ifdef RATE20MHZ
	MPAT 20MHZ_patFlash
#elif (defined RATE15MHZ)
	MPAT 15MHZ_patFlash
#elif (defined RATE10MHZ)
	MPAT 10MHZ_patFlash
#elif (defined RATE5MHZ)
	MPAT 5MHZ_patFlash
#endif

RDX 10
MODE TPM36
MODE TP2INV

%INSERT subdef

REGISTER
	CPE1	=	R
	DRE1	=	W
	YMAX	=	#FFFFFF
	XMAX	=	#FFFFFF 
	IDX7	=	#3		;;-- idle cycle after cmd
;;--	ZH	= 	0x1		;;-- flash no
;       ZH	= 	0x07		;;-- special for flash no 067T
	ZH	= 	0xF		;;-- special for flash no 067T


;;--*************************************************************************************************	
;;--*************************************************************************************************	
;;--part 1 :set up pattern 	
START SOC_POWER_RESET
	NOP			C1     C5   	TS2
	IDXI6 18                C1       	TS2
;	IDXI6 0			C1     SCE		TS2
;refactor from 1st version
;	IDXI6 0		C4	C1      	TS2
;	IDXI6 0			C1		TS2
;	NOP		C4  	C1        	TS2
;	NOP			C1        	TS2
;;1 C19 for WTRC watch
	IDXI6 7 	C5	C4  	C1     C19  SCE   TS2   ;1 LSB
;6
	IDXI6 7	        C5	C1     SCE   	TS2   ;0 
	IDXI6 7		C5  C4	C1     SCE  	TS2   ;1
	IDXI6 7		C5  C4	C1     SCE  	TS2   ;1
	IDXI6 7	        C5	C1     SCE    	TS2   ;0

;A
	IDXI6 7		C5  C4  	C1     SCE    	TS2   ;1 
	IDXI6 7		C5	C1     SCE    	TS2   ;0 
	IDXI6 7		C5  C4  C1     SCE    	TS2   ;1 
	IDXI6 7	        C5	C1     SCE    	TS2   ;0 
;7
	IDXI6 7	        C5	C1     SCE    	TS2   ;0 
	IDXI6 25    C5	C4	C1     SCE          TS2   ;111
;8
	IDXI6 7	    C5	C4  	C1     SCE    	TS2   ;1 
	IDXI6 25    C5		C1     SCE  	TS2   ;000
;6
	IDXI6 7	    C5		C1     SCE    	TS2   ;0 
	IDXI6 16    C5	C4  	C1     SCE    	TS2   ;11 
	IDXI6 7	    C5		C1     SCE    	TS2   ;0 
;4
	IDXI6 7	    C5		C1     SCE    	TS2   ;0 
	IDXI6 7	    C5	C4  	C1     SCE    	TS2   ;1 
	IDXI6 16    C5		C1     SCE    	TS2   ;00 
;7
	IDXI6 7	    C5		C1     C18   SCE 	TS2   ;0 
	IDXI6 25    C5	C4	C1           SCE 	TS2   ;111
;A
	IDXI6 7	    C5	C4  	C1     SCE   	TS2   ;1 
	IDXI6 7	    C5		C1     SCE    	TS2   ;0 
	IDXI6 7	    C5	C4  	C1     SCE    	TS2   ;1 
	IDXI6 7	    C5		C1     SCE    	TS2   ;0 
;0
	IDXI6 34    C5		C1     SCE    	TS2   ;0000 
;1
	IDXI6 25    C5		C1     SCE    	TS2   ;000 
	IDXI6 7	    C5	C4  	C1     SCE    	TS2   ;1 
;0
	IDXI6 34    C5		C1     SCE    	TS2   ;0000 

;1
	IDXI6 25    C5		C1     SCE    	TS2   ;000 
	IDXI6 7	    C5	C4  	C1     SCE    	TS2   ;1 
;4
	IDXI6 7	    C5		C1     SCE    	TS2   ;0 
	IDXI6 7	    C5	C4  	C1     SCE    	TS2   ;1 
	IDXI6 16    C5		C1     SCE    	TS2   ;00 
;2
	IDXI6 16    C5		C1      C17  	SCE  TS2   ;00 
	IDXI6 7	    C5	C4  	C1        	SCE  TS2   ;1 
	IDXI6 7	    C5		C1        	SCE  TS2   ;0 
;5
	IDXI6 7	    C5		C1      SCE   	TS2   ;0 
	IDXI6 7	    C5	C4  	C1      SCE   	TS2   ;1 
	IDXI6 7	    C5		C1      SCE   	TS2   ;0 
	IDXI6 7	    C5	C4  	C1      SCE   	TS2   ;1 
;3
	IDXI6 16    C5		C1      SCE   	TS2   ;00 
	IDXI6 16    C5	C4  	C1      SCE   	TS2   ;11 
;4
	IDXI6 7	    C5		C1      SCE   	TS2   ;0 
	IDXI6 7	    C5	C4  	C1      SCE   	TS2   ;1 
	IDXI6 16    C5		C1      SCE   	TS2   ;00 
;5
	IDXI6 7	    C5		C1      SCE   	TS2   ;0 
	IDXI6 7	    C5	C4  	C1      SCE   	TS2   ;1 
	IDXI6 7	    C5		C1      SCE   	TS2   ;0 
	IDXI6 7	    C5	C4  	C1      SCE   	TS2   ;1 
;4
	IDXI6 7	    C5		C1      SCE   	TS2   ;0 
	IDXI6 7	    C5	C4  	C1      SCE   	TS2   ;1 
	IDXI6 16    C5		C1      SCE   	TS2   ;00 
;5
	IDXI6 7	    C5		C1      SCE   	TS2   ;0 
	IDXI6 7	    C5	C4  	C1      SCE   	TS2   ;1 
	IDXI6 7	    C5		C1      SCE   	TS2   ;0 
	IDXI6 7	    C5	C4  	C1      SCE   	TS2   ;1 

;4
	IDXI6 7	    C5		C1      SCE  C23 	TS2   ;0
	IDXI6 7	    C5	C4  	C1      SCE   	TS2   ;1
	IDXI6 16    C5		C1      SCE   	TS2   ;00
;e
	IDXI6 25    C5	C4	C1      SCE         TS2   ;111
	IDXI6 7	    C5		C1      SCE   	TS2   ;0 
	IDXI6 607   C5		C1      SCE   	TS2
;	NOP			C1  C5	     	TS2;PORSTn reset
;	NOP			C1  	    	TS2
;	IDXI6 10		C1      	TS2
;	STPS	
	JSR SUB_FLASH_FN_STBR_READ	Z<ZH TP<TPH1 TP2<TPH2
 ;STPS			    C5         TS1	
 ;STPS			   C1          TS2 	
 STPS			    	

START NVR_CFG_PRO_REPAIRED_ROWS_UBM;need to check
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH 
	JSR SUB_FLASH_SH_CFGLK_00
	NOP D1A<#80FFF6	AREA_NC UBM_CLR UBM_ENB          ;RR0
	JSR SUB_FLASH_FN_NORL_PROG_UBM  XC<D1A YC<D2A 
	NOP D1A<#80FFF7	AREA_NC                          ;RR1
	JSR SUB_FLASH_FN_NORL_PROG_UBM  XC<D1A YC<D2A 
	NOP D1A<#80FFF5	AREA_NC                          ;CFG_CHK1 for 07gd
	JSR SUB_FLASH_FN_NORL_PROG_UBM  XC<D1A YC<D2A 
	NOP D1A<#8FFFB6	AREA_NC UBM_CLR UBM_ENB
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#8FFFB7	AREA_NC
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#8FFFB5	AREA_NC
	JSR SUB_FLASH_FN_NORL_PROG_UBM  XC<D1A YC<D2A 
	JSR SUB_FLASH_SH_CFGLK_01 
	STPS

START NVR_CFG_READ_REPAIRED_ROWS_UBM;need to check
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH 
;	JSR SUB_FLASH_SH_CFGLK_01
	JSR SUB_FLASH_SH_RECAL_01
	NOP D1A<#80FFF6	AREA_NC UBM_CLR UBM_ENB
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#80FFF7	AREA_NC
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#80FFF5	AREA_NC ;CFG_CHK1 for 07gd
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	JSR SUB_FLASH_SH_RECAL_00
	STPS


START RFCUR_TRIM_DPROGX72B
	; 16k even row hb36
	NOP	D1A<#4007B3	D2A<#0   Z<ZH
	JSR SUB_FLASH_FN_NORL_PROG		XC<D1A YC<D2A	TP2<#FFBFFFEFF             ;16KX72:ADDR: 0X7B3(even), 0X7F3(odd)
	; 16k even row lb36
	NOP	D1A<#8007B3	D2A<#0
	JSR SUB_FLASH_FN_NORL_PROG		XC<D1A YC<D2A	TP2<#FFBFFFEFF
	; 16k odd row hb36
	NOP	D1A<#4007F3	D2A<#0
	JSR SUB_FLASH_FN_NORL_PROG		XC<D1A YC<D2A	TP2<#7FFFDFFFF
	; 16k odd row lb36
	NOP	D1A<#8007F3	D2A<#0
	JSR SUB_FLASH_FN_NORL_PROG		XC<D1A YC<D2A	TP2<#7FFFDFFFF
	STPS


START MBIST_MUX_SETUP
	JSR SUB_FLASH_SH_MBIST_01	Z<ZH
	STPS
START WRITE_SOC_REG
	JSR SUB_FLASH_FN_SOCR_WRIT	Z<ZH  TP<TPH1 TP2<TPH2
	STPS
START WRITE_SOC_REG_UBM
	NOP UBM_CLR
	JSR SUB_FLASH_FN_SOCR_WRIT_UBM	Z<ZH  TP<TPH1 TP2<TPH2
	STPS
START READ_STB_REG
	JSR SUB_FLASH_FN_STBR_READ	Z<ZH TP<TPH1 TP2<TPH2
	STPS
START READ_STB_REG_UBM
	NOP UBM_CLR
	JSR SUB_FLASH_FN_STBR_READ_UBM	Z<ZH TP<TPH1 TP2<TPH2
	STPS
START READ_STB_REG_MMA
	JSR SUB_FLASH_FN_STBR_READ_MMA	Z<ZH	XC<D1C YC<D2C  TP1<TPH1 TP2<TPH2
	NOP	AFMXFER
	JBF .			
	STPS
START FN_NORL_READ_BFAIL_REG_MMA 
	JSR SUB_FLASH_FN_BFRE_READ_MMA Z<ZH XC<0 YC<0
	NOP AFMXFER
	JBF .
	STPS
START FLASH_IP_RESET
	JSR SUB_FLASH_SH_RESET_00	Z<ZH
	JSR SUB_FLASH_SH_RESET_01
	STPS
START CHIP_ENABLE
	JSR SUB_FLASH_SH_CHIEN_00	Z<ZH
	STPS
START WRITE_TIMING_FRE05M
	NOP				 YC<0	D1A<#0	Z<ZH		
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#1	TP1<#121212120
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#2	TP1<#090909090
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#3	TP1<#232323230
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#4	TP1<#131313130
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#5	TP1<#0D0D0D0D0
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#6	TP1<#323232320
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#7	TP1<#323232320
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#8	TP1<#121212120
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#9	TP1<#383838380
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#A	TP1<#202020200
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#B	TP1<#131313130
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A		 	TP1<#121212120
	STPS
;START WRITE_TIMING_FRE05M
;	NOP				 YC<0	D1A<#0	Z<ZH		
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#1	TP1<#121212120
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#2	TP1<#090909090
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#3	TP1<#232323230
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#4	TP1<#131313130
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#5	TP1<#0D0D0D0D0
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#6	TP1<#323232320
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#7	TP1<#323232320
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#8	TP1<#121212120
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#9	TP1<#383838380
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#A	TP1<#202020200
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#B	TP1<#131313130
;	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A		 	TP1<#121212120
;	STPS

START WRITE_TIMING_FRE10M
	NOP				 YC<0  	D1A<#0	Z<ZH		
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#1	TP1<#232323230
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#2	TP1<#121212120
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#3	TP1<#363636360
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#4	TP1<#262626260
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#5	TP1<#191919190
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#6	TP1<#646464640
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#7	TP1<#646464640
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#8	TP1<#232323230
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#9	TP1<#717171710
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#A	TP1<#3F3F3F3F0
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#B	TP1<#454545450
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A 		TP1<#232323230
	STPS
START WRITE_TIMING_FRE15M
	NOP				 YC<0  	D1A<#0	Z<ZH		
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#1	TP1<#343434340
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#2	TP1<#1B1B1B1B0
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#3	TP1<#595959590
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#4	TP1<#393939390
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#5	TP1<#262626260
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#6	TP1<#979797970
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#7	TP1<#979797970
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#8	TP1<#353535350
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#9	TP1<#A9A9A9A90
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#A	TP1<#5E5E5E5E0
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#B	TP1<#686868680
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A 		TP1<#353535350
	STPS
START WRITE_TIMING_FRE20M
	NOP				 YC<0  	D1A<#0	Z<ZH		
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#1	TP1<#454545450
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#2	TP1<#242424240
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#3	TP1<#6C6C6C6C0
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#4	TP1<#4B4B4B4B0
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#5	TP1<#323232320
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#6	TP1<#C8C8C8C80
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#7	TP1<#C8C8C8C80
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#8	TP1<#464646460
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#9	TP1<#E1E1E1E10
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#A	TP1<#7D7D7D7D0
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A D1A<#B	TP1<#9A9A9A9A0
	JSR SUB_FLASH_FN_STIR_WRIT	 XC<D1A 		TP1<#464646460
	STPS
START READ_TIMING_FRE05M
	NOP				 YC<0	D1A<#0	Z<ZH		
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#1	TP1<#121212120
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#2	TP1<#090909090
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#3	TP1<#232323230
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#4	TP1<#131313130
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#5	TP1<#0D0D0D0D0
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#6	TP1<#323232320
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#7	TP1<#323232320
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#8	TP1<#121212120
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#9	TP1<#383838380
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#A	TP1<#202020200
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#B	TP1<#131313130
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A 		TP1<#121212120
	STPS
START READ_TIMING_FRE10M
	NOP				 YC<0	D1A<#0	Z<ZH		
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#1	TP1<#232323230
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#2	TP1<#121212120
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#3	TP1<#363636360
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#4	TP1<#262626260
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#5	TP1<#191919190
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#6	TP1<#646464640
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#7	TP1<#646464640
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#8	TP1<#232323230
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#9	TP1<#717171710
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#A	TP1<#3F3F3F3F0
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#B	TP1<#454545450
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A 		TP1<#232323230
	STPS
START READ_TIMING_FRE15M
	NOP				 YC<0	D1A<#0	Z<ZH		
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#1	TP1<#343434340
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#2	TP1<#1B1B1B1B0
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#3	TP1<#595959590
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#4	TP1<#393939390
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#5	TP1<#262626260
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#6	TP1<#979797970
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#7	TP1<#979797970
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#8	TP1<#353535350
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#9	TP1<#A9A9A9A90
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#A	TP1<#5E5E5E5E0
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#B	TP1<#686868680
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A 		TP1<#353535350
	STPS
START READ_TIMING_FRE20M
	NOP				 YC<0  	D1A<#0	Z<ZH		
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#1	TP1<#454545450
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#2	TP1<#242424240
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#3	TP1<#6C6C6C6C0
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#4	TP1<#4B4B4B4B0
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#5	TP1<#323232320
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#6	TP1<#C8C8C8C80
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#7	TP1<#C8C8C8C80
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#8	TP1<#464646460
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#9	TP1<#E1E1E1E10
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#A	TP1<#7D7D7D7D0
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A D1A<#B	TP1<#9A9A9A9A0
	JSR SUB_FLASH_FN_STIR_READ	 XC<D1A 		TP1<#464646460
	STPS
;;;--- START FLASH_SH_MBIST_00  		
;;;--- 	JSR SUB_FLASH_SH_MBIST_00	Z<ZH  		
;;;--- 	STPS
;;;--- START FLASH_SH_MBIST_01
;;;--- 	JSR SUB_FLASH_SH_MBIST_01	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_RESET_00
;;;--- 	JSR SUB_FLASH_SH_RESET_00	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_RESET_01
;;;--- 	JSR SUB_FLASH_SH_RESET_01	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_CHIEN_00
;;;--- 	JSR SUB_FLASH_SH_CHIEN_00	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_CHIEN_01
;;;--- 	JSR SUB_FLASH_SH_CHIEN_01	Z<ZH
;;;--- 	STPS
START FLASH_SH_DEPDP_00
	JSR SUB_FLASH_SH_DEPDP_00	Z<ZH
	STPS
START FLASH_SH_DEPDP_01
	JSR SUB_FLASH_SH_DEPDP_01	Z<ZH
	STPS
START FLASH_SH_RECAL_00
	JSR SUB_FLASH_SH_RECAL_00	Z<ZH
	STPS
START FLASH_SH_RECAL_01
	JSR SUB_FLASH_SH_RECAL_01	Z<ZH
	STPS
START FLASH_SH_CFGLK_00
	JSR SUB_FLASH_SH_CFGLK_00	Z<ZH
	STPS
START FLASH_SH_CFGLK_01
	JSR SUB_FLASH_SH_CFGLK_01	Z<ZH
	STPS
START FLASH_SH_VREAD_00
	JSR SUB_FLASH_SH_VREAD_00	Z<ZH
	STPS
START FLASH_SH_VREAD_01
	JSR SUB_FLASH_SH_VREAD_01	Z<ZH
	STPS
;;;--- START FLASH_SH_RETRY_00
;;;--- 	JSR SUB_FLASH_SH_RETRY_00	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_RETRY_01
;;;--- 	JSR SUB_FLASH_SH_RETRY_01	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_RETRY_10
;;;--- 	JSR SUB_FLASH_SH_RETRY_10	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_RETRY_11
;;;--- 	JSR SUB_FLASH_SH_RETRY_11	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_LVCTL_00
;;;--- 	JSR SUB_FLASH_SH_LVCTL_00	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_LVCTL_01
;;;--- 	JSR SUB_FLASH_SH_LVCTL_01	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_COUNT_00
;;;--- 	JSR SUB_FLASH_SH_COUNT_00	Z<ZH
;;;--- 	STPS
;;;--- START FLASH_SH_COUNT_01
;;;--- 	JSR SUB_FLASH_SH_COUNT_01	Z<ZH
;;;--- 	STPS
START FLASH_SH_ADDRS_00
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH
	STPS
START FLASH_SH_ADDRS_01
	JSR SUB_FLASH_SH_ADDRS_01	Z<ZH
	STPS

;;--*************************************************************************************************	
;;--*************************************************************************************************	
;;--part 2 :trim pattern & measure pattern  	

START CHIP_ERAS_VEG_TRIM_UBM
	NOP UBM_CLR
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_DIVMEAS_XVONVEP2
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
;	JSR SUB_FLASH_FN_CHIP_ERAS XC<0 YC<0
	JSR SUB_FLASH_FN_QCHI_ERAS XC<0 YC<0
	JMP . IDLE 
	STPS
START PROG_VCG_TRIM_UBM
	NOP UBM_CLR
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_DIVMEAS_XVONVEP2
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	JSR SUB_FLASH_FN_NORL_PROG XC<0 YC<0 TP1<#FFFFFFFFF TP2<#FFFFFFFFF
	JMP . IDLE 
	STPS
START PROG_VSL_TRIM_UBM
	NOP UBM_CLR
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_XVONSL	Z<ZH	;110 TM_10
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	JSR SUB_FLASH_FN_NORL_PROG XC<0 YC<0 TP1<#FFFFFFFFF TP2<#FFFFFFFFF 	
	JMP . IDLE 
	STPS
START CHIP_ERAS_VEG_TRIM_UBM_LOOP
	NOP UBM_CLR  
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
	JMP . IDLE 
	STPS
START PROG_VCG_TRIM_UBM_LOOP
	NOP UBM_CLR
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
	JMP . IDLE 
	STPS
START PROG_VSL_TRIM_UBM_LOOP
	NOP UBM_CLR
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
	JMP . IDLE 
	STPS
START HV_TRIM_EXIT_QERASE
	JSR SUB_FLASH_SH_COUNT_01_QERASE	Z<ZH
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS

START HV_TRIM_EXIT_ERASE
	JSR SUB_FLASH_SH_COUNT_01_ERASE	Z<ZH
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START HV_TRIM_EXIT_PROG
	JSR SUB_FLASH_SH_COUNT_01_PRG	Z<ZH
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START RFCUR_TRIM_DPROG
	JSR SUB_FLASH_FN_NORL_PROG		XC<D1C YC<D2C	TP1<TPH1A   Z<ZH
	JSR SUB_FLASH_FN_NORL_PROG		XC<D1D YC<D2C	TP1<TPH1B
	STPS
START NORM_RD_TRIM
	JSR SUB_FLASH_TM FLASH_TM_TRM_RD	Z<ZH
	JSR SUB_FLASH_TMENT
	NOP	D1A<#0 D2A<#00
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP1<#FFFFF7FC9
	NOP	D3<0	TPH1<0		UBM_CLR
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C	TP1<TPH1
	JSR SUB_FLASH_FN_SLOW_READ_WO_CPE XC<D1D YC<D2A TP1<#0 TP2<#0
	JSR SUB_FLASH_FN_CDAT_READ XC<D3 YC<D2A TP1<#0
	JNC1	.+2
	JNI1 	.-4			D3<D3+1
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START MRG1_RD_TRIM
	JSR SUB_FLASH_TM FLASH_TM_TRM_RD	Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_MRG1
	JSR SUB_FLASH_TMENT
	NOP	D1A<#0	D2A<#00		;CBD0
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP1<#FFFFFBFC9	;B 101
	NOP	D3<0	TPH1<0		UBM_CLR
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C	TP1<TPH1	;need scan B[4:0]	CBD6
	JSR SUB_FLASH_FN_SLOW_READ_WO_CPE XC<D1D YC<D2A TP1<#0 TP2<#0
	JSR SUB_FLASH_FN_CDAT_READ XC<D3 YC<D2A TP1<#0
	JNC1	.+2
	JNI1 	.-4			D3<D3+1
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START MRG0_RD_TRIM
	JSR SUB_FLASH_TM FLASH_TM_TRM_RD	Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_MRG0
	JSR SUB_FLASH_TMENT
	NOP	D1A<#0	D2A<#00		;CBD0
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP1<#FFFFFFFC9	;04L2
	NOP	D3<0	TPH1<0		UBM_CLR
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C	TP1<TPH1	;need scan B[14:10]
	JSR SUB_FLASH_FN_SLOW_READ_WO_CPE XC<D1D YC<D2A TP1<#0 TP2<#0
	JSR SUB_FLASH_FN_CDAT_READ XC<D3 YC<D2A TP1<#0
	JNC1	.+2
	JNI1 	.-4			D3<D3+1
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START VREAD1_TRIM
	JSR SUB_FLASH_SH_VREAD_01	Z<ZH 
	JSR SUB_FLASH_TM FLASH_TM_TRM_RD	Z<ZH
	JSR SUB_FLASH_TMENT
	NOP	D1A<#0	D2A<#00		;CBD0
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP1<#FFFFF7FC9	;06s8 111,72bit: 011
	NOP	D3<0	TPH1<0		UBM_CLR
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1C YC<D2C	TP1<TPH1 	;need scan B[9:5]
	JSR SUB_FLASH_FN_SLOW_READ_WO_CPE XC<D1D YC<D2A TP1<#0 TP2<#0
	JSR SUB_FLASH_FN_CDAT_READ XC<D3 YC<D2A TP1<#0
	JNC1	.+2
	JNI1 	.-4			D3<D3+1
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	JSR SUB_FLASH_SH_VREAD_00
	STPS
START MEAS_VEG_CHIP_ERASE
	JSR SUB_FLASH_TM FLASH_TM_DIVMEAS_XVONVEP2	Z<ZH 	
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	JSR SUB_FLASH_FN_CHIP_ERAS XC<0 YC<0
	JMP . IDLE 
	STPS
START MEAS_VEG_QCHI_ERASE
	JSR SUB_FLASH_TM FLASH_TM_DIVMEAS_XVONVEP2	Z<ZH 	
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	JSR SUB_FLASH_FN_QCHI_ERAS XC<0 YC<0
	JMP . IDLE 
	STPS

START MEAS_VCG_PROG
	JSR SUB_FLASH_TM FLASH_TM_DIVMEAS_XVONVEP2	Z<ZH
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	JSR SUB_FLASH_FN_NORL_PROG XC<0 YC<0 TP1<#FFFFFFFFF TP2<#FFFFFFFFF
	JMP . IDLE 
	STPS
START MEAS_VSL_PROG
	JSR SUB_FLASH_TM FLASH_TM_XVONSL	Z<ZH
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	JSR SUB_FLASH_FN_NORL_PROG XC<0 YC<0 TP1<#FFFFFFFFF TP2<#FFFFFFFFF
	JMP . IDLE
	STPS
START SET_FLASH_CFG_UBM
	NOP UBM_CLR
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH
	NOP D1A<#0
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<D1A YC<D2C
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<XC+1 YC<D2C
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<XC+1 YC<D2C
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<XC+1 YC<D2C
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<XC+1 YC<D2C
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<XC+1 YC<D2C
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<XC+1 YC<D2C
	JSR SUB_FLASH_FN_CONF_WRIT_UBM XC<XC+1 YC<D2C
	STPS

;;--*************************************************************************************************	
;;--*************************************************************************************************	
;;--part 3 :nvr_cfg program and read and reload  	

START NVR_CFG_UNLOCK_SECT_ERAS
	NOP						 	Z<ZH	XC<D1C YC<D2C  
	JSR SUB_FLASH_SH_CFGLK_00
	JSR SUB_FLASH_FN_SECT_ERAS 
	STPS
START NVR_CFG_LOCK_EN_SECT_ERAS
	NOP						 	Z<ZH	XC<D1C YC<D2C  
	JSR SUB_FLASH_SH_CFGLK_01
	JSR SUB_FLASH_FN_SECT_ERAS 
	STPS
START NVR_CFG_PROG_UBM_UBM
	;JSR SUB_FLASH_SH_ADDRS_00	Z<ZH	 UBM_CLR	AREA_NC  
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH	 UBM_CLR	 
	JSR SUB_FLASH_SH_CFGLK_00
	JSR SUB_FLASH_FN_NORL_PROG_UBM_UBM	YC<D2C
	JNC1 .+2
	JNI1 .-2
	JSR SUB_FLASH_SH_CFGLK_01
	STPS
START NVR_CFG_PROG_UBM_UBM_2ROW
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH	 UBM_CLR	AREA_NC  
	JSR SUB_FLASH_SH_CFGLK_00	D1A<#FFFF 		;for 24bit X address ,only row shift bit effective
	JSR SUB_FLASH_FN_NORL_PROG_2UBM_ROWM	YC<D2C  XC<0	;for odd row
	JNC1 .+2
	JNI1 .-2
	NOP	 C22 				UBM_CLR
	JSR SUB_FLASH_FN_NORL_PROG_2UBM_ROWM	YC<D2C  XC<D1A    ;for even row
	JNC1 .+2
	JNI1 .-2
	JSR SUB_FLASH_SH_CFGLK_01
	STPS

START NVR_CFG_PROG_VCODE_TCODE
;	JSR SUB_FLASH_SH_CFGLK_00
	NOP D1A<#807FE0 Z<ZH AREA_NC UBM_ENB UBM_CLR ;Vcode_trim
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#807FE1  AREA_NC                       ;Vcode=0000,0001,0010 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#407FE1  AREA_NC                       ;Vcode=0011,0100,0101 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#807FE2  AREA_NC                       ;Vcode=0110,0111,1000 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#407FE2  AREA_NC                       ;Vcode=1001,1010,1011 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#807FE3  AREA_NC                       ;Vcode=1100,1101,1110 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#407FE3  AREA_NC                       ;Tcode=0000,0001 Vcode=Vcode_trim; Vcode=1111;
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 

	NOP D1A<#807FA0 Z<ZH    AREA_NC UBM_ENB UBM_CLR ;Vcode_trim
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#807FA1  AREA_NC                       ;Vcode=0000,0001,0010 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#407FA1  AREA_NC                       ;Vcode=0011,0100,0101 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#807FA2  AREA_NC                       ;Vcode=0110,0111,1000 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#407FA2  AREA_NC                       ;Vcode=1001,1010,1011 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#807FA3  AREA_NC                       ;Vcode=1100,1101,1110 Tcode=1000
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#407FA3  AREA_NC                       ;Tcode=0000,0001 Vcode=Vcode_trim;Vcode=1111;
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	STPS
START NVR_CFG_READ_VCODE_TCODE
;	JSR SUB_FLASH_SH_CFGLK_00
	JSR SUB_FLASH_SH_RECAL_01
	NOP D1A<#807FE0 Z<ZH    AREA_NC UBM_ENB UBM_CLR ;Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A
	NOP D1A<#807FE1  AREA_NC                       ;Vcode=0000,0001,0010 Tcode=1000
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#807FE2  AREA_NC                       ;Vcode=0110,0111,1000 Tcode=1000
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#807FE3  AREA_NC                       ;Vcode=1100,1101,1110 Tcode=1000
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#807FE4  AREA_NC                       ;Tcode=0010,0011,0100 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#807FE5  AREA_NC                       ;Tcode=1000,1001,1010 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#807FE6  AREA_NC                       ;Tcode=1110,1111 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	JSR SUB_FLASH_SH_RECAL_00
	STPS


START NVR_CFG_READ_TRIM_40;need to check
	JSR SUB_FLASH_SH_RECAL_01
	NOP D1A<#807FC1	Z<ZH	AREA_NC	
	NOP UBM_CLR UBM_ENB 
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#807FC0		AREA_NC
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
        JSR SUB_FLASH_SH_CFGLK_00
	JSR SUB_FLASH_SH_RECAL_00
	STPS



START NVR_CFG_READ_UBM_UBM
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH	 UBM_CLR	AREA_NC
	JSR SUB_FLASH_SH_RECAL_01
	JSR SUB_FLASH_FN_SLOW_READ_UBM_UBM	YC<D2C
	JNC1 .+2
	JNI1 .-2
	JSR SUB_FLASH_SH_RECAL_00
	STPS
START NVR_CFG_READ_UBM_MMA
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH	 UBM_CLR	AREA_NC
	JSR SUB_FLASH_SH_RECAL_01
	JSR SUB_FLASH_FN_SLOW_READ_UBM_MMA	YC<D2C	 TP1<TPH1 TP2<TPH2
	JNC1 .+2
	JNI1 .-2				XC<XC+1		;FCM addr in XC 
	JSR SUB_FLASH_SH_RECAL_00
	NOP AFMXFER
	JBF .
	STPS
START NVR_CFG_READ_ADDR_UBM
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH	 UBM_CLR	AREA_NC
	JSR SUB_FLASH_SH_RECAL_01
	JSR	SUB_FLASH_FN_SLOW_READ_ADDR_UBM TP1<TPH1 TP2<TPH2 YC<D2C
	JNC1 .+2
	JNI1 .-2				XC<XC+1	
	JSR SUB_FLASH_SH_RECAL_00
	STPS
START RELOAD_ALL_TRIM_CODE
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH
	NOP D1A<#8FFFF8 AREA_NC   Z<ZH 
	JSR SUB_FLASH_FN_ACON_WRIT XC<D1A YC<D2A TP1<#0 TP2<#0
	NOP D1A<#8FFFF9 AREA_NC
	JSR SUB_FLASH_FN_ACON_WRIT XC<D1A YC<D2A TP1<#0 TP2<#0
	NOP D1A<#8FFFFA AREA_NC
	JSR SUB_FLASH_FN_ACON_WRIT XC<D1A YC<D2A TP1<#0 TP2<#0
	NOP D1A<#8FFFFB AREA_NC
	JSR SUB_FLASH_FN_ACON_WRIT XC<D1A YC<D2A TP1<#0 TP2<#0
	NOP D1A<#8FFFFC AREA_NC
	JSR SUB_FLASH_FN_ACON_WRIT XC<D1A YC<D2A TP1<#0 TP2<#0
	NOP D1A<#8FFFFD AREA_NC
	JSR SUB_FLASH_FN_ACON_WRIT XC<D1A YC<D2A TP1<#0 TP2<#0
	NOP D1A<#8FFFFE AREA_NC
	JSR SUB_FLASH_FN_ACON_WRIT XC<D1A YC<D2A TP1<#0 TP2<#0
	NOP D1A<#8FFFFF AREA_NC
	JSR SUB_FLASH_FN_ACON_WRIT XC<D1A YC<D2A TP1<#0 TP2<#0
	STPS
START NVR_CFG_PRO_ID
	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH
	JSR SUB_FLASH_SH_CFGLK_00
	JSR SUB_FLASH_FN_NORL_PROG XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_NORL_PROG XC<XC+D1B YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_SH_CFGLK_01
	STPS
START NVR_CFG_RD_ID
	JSR SUB_FLASH_SH_RECAL_01  Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR	SUB_FLASH_FN_SLOW_READ
	JSR SUB_FLASH_SH_RECAL_00
	STPS
START NVR_CFG_RD_ID_H36
	JSR SUB_FLASH_SH_RECAL_01  Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR	SUB_FLASH_FN_SLOW_READ_H36
	JSR SUB_FLASH_SH_RECAL_00
	STPS
START NVR_CFG_RD_ID_L36
	JSR SUB_FLASH_SH_RECAL_01  Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR	SUB_FLASH_FN_SLOW_READ_L36
	JSR SUB_FLASH_SH_RECAL_00
	STPS

;;--*************************************************************************************************	
;;--*************************************************************************************************	
;;--part 4 :repair related pattern 	

START  FLASH_BI_CLEAR_FAIL
	JSR SUB_FLASH_BI_CLEAR_FAIL Z<ZH XC<0 YC<0
	STPS
START CHECK_ERROR_MAIN_BFRE 
	JSR SUB_FLASH_FN_BFRE_READ_BIST_ERR3 Z<ZH XC<0 YC<0
	STPS
START CHECK_SORT2_BFRE 
	JSR SUB_FLASH_FN_BFRE_READ_MMA Z<ZH XC<0 YC<0
	NOP AFMXFER
	JBF .
	STPS

;;--*************************************************************************************************	
;;--*************************************************************************************************	
;;--part 5 :stress and special pattern 	

START MEO_PROG_00_M_R
        JSR SUB_FLASH_TM FLASH_TM_NORGL5V    Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2    ;       for 40
        JSR SUB_FLASH_TM FLASH_TM_XVONSL
        JSR SUB_FLASH_TM FLASH_TM_MEO
        JSR SUB_FLASH_TM FLASH_TM_DSPUMPSL
        JSR SUB_FLASH_TMENT
        JSR SUB_FLASH_SH_COUNT_00
        JSR SUB_FLASH_FN_NORL_PROG_2MS
        JSR SUB_FLASH_SH_COUNT_01_PRG
        JNC1 .+2
        JNI1 .-4                                                XC<XC+D1B
        JSR SUB_FLASH_TMEXT
        JSR SUB_FLASH_TMNXT
        STPS
START GOX_STRESS
	JSR SUB_FLASH_TM FLASH_TM_NORGL11V	Z<ZH XC<D1C YC<D2C	TP1<TPH1 TP2<TPH2       ;for 40
	JSR SUB_FLASH_TM FLASH_TM_XVONVEP
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	NOP	AREA_M_R_N
	JSR SUB_FLASH_FN_CHIP_ERAS_500MS	XC<0 YC<D2A 
	JSR SUB_FLASH_SH_COUNT_01_ERASE	
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START GOX_STRESS_INTERNAL
	JSR SUB_FLASH_SH_COUNT_00	Z<ZH
	NOP	AREA_M_R_N
	JSR SUB_FLASH_FN_CHIP_ERAS_500MS	XC<0 YC<D2A 
	JSR SUB_FLASH_SH_COUNT_01_ERASE	
	STPS
START READ_MARGIN0_2_8ROWS00
	JSR SUB_FLASH_TM FLASH_TM_MRG0	Z<ZH XC<D1C YC<D2C TP1<#0 TP2<#0
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	NOP		XC<D1C YC<D2C TP1<#0 TP2<#0
	JSR SUB_FLASH_BI_RSLRD_NORL        TP1<#0 TP2<#0
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JNC1 .+2
	JNI1 .-3						XC<XC+D1B
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MEO_FN_NORL_PROG
        JSR SUB_FLASH_TM FLASH_TM_NORGL5V    Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2    ;       for 40
        JSR SUB_FLASH_TM FLASH_TM_XVONSL
        JSR SUB_FLASH_TM FLASH_TM_MEO
        JSR SUB_FLASH_TM FLASH_TM_DSPUMPSL
        JSR SUB_FLASH_TMENT
        JSR SUB_FLASH_SH_COUNT_00                                                              
        JSR SUB_FLASH_FN_NORL_PROG_8MS                                                              
        JSR SUB_FLASH_SH_COUNT_01_PRG
        JNC1 .+2
        JNI1 .-4                                                XC<XC+D1B
        JSR SUB_FLASH_TMEXT
        JSR SUB_FLASH_TMNXT
        STPS
START MARGIN0_CG3P5_MODE
	JSR SUB_FLASH_TM FLASH_TM_MRG0		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_EXCGB		;only for 40EF
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	STPS
START TMODE_EXIT
	JSR SUB_FLASH_TMEXT  Z<ZH
	JSR SUB_FLASH_TMNXT
	STPS
START COX_STRESS
	JSR SUB_FLASH_TM FLASH_TM_NWLNV	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NORGL11V
	JSR SUB_FLASH_TM FLASH_TM_XVONVEP
	JSR SUB_FLASH_TM FLASH_TM_MEO
	JSR SUB_FLASH_TM FLASH_TM_SL0V
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	NOP	AREA_M_R_N
	JSR SUB_FLASH_FN_NORL_PROG_200MS XC<0 YC<D2A TP1<#FFFFFFFFF TP2<#FFFFFFFFF
	JSR SUB_FLASH_SH_COUNT_01_PRG
	JSR SUB_FLASH_TMEXT	
	JSR SUB_FLASH_TMNXT
	STPS
START COX_STRESS_INTERNAL
	JSR SUB_FLASH_TM FLASH_TM_NWLNV	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_MEO
	JSR SUB_FLASH_TM FLASH_TM_SL0V
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	NOP	AREA_M_R_N
	JSR SUB_FLASH_FN_NORL_PROG_200MS XC<0 YC<D2A TP1<#FFFFFFFFF TP2<#FFFFFFFFF
	JSR SUB_FLASH_SH_COUNT_01_PRG
	JSR SUB_FLASH_TMEXT	
	JSR SUB_FLASH_TMNXT
	STPS
START COX2_STRESS
	JSR SUB_FLASH_TM FLASH_TM_EXCGB	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOWL
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_WAIT_200MS
	JSR SUB_FLASH_TMEXT	
	JSR SUB_FLASH_TMNXT
	STPS
START SOL_OX_STRESS
	JSR SUB_FLASH_TM FLASH_TM_NWLNV	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NORGL5V
	JSR SUB_FLASH_TM FLASH_TM_XVONSL
	JSR SUB_FLASH_TM FLASH_TM_MEO
	JSR SUB_FLASH_TM FLASH_TM_CG0V
	JSR SUB_FLASH_TM FLASH_TM_DSPUMPSL
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	JSR SUB_FLASH_FN_NORL_PROG_100MS 
	JSR SUB_FLASH_SH_COUNT_01_PRG
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START RDIST_STRESS
	JSR SUB_FLASH_TM FLASH_TM_RDST	Z<ZH XC<D1C YC<D2C
	JSR SUB_FLASH_TM FLASH_TM_EXVWL
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_SH_COUNT_00
	JSR SUB_FLASH_FN_CHIP_ERAS_50MS 
	JSR SUB_FLASH_SH_COUNT_01_ERASE
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START FN_ENDURANCE_SCR
	JSR SUB_FLASH_TM FLASH_TM_NORGL11V	Z<ZH 	
	JSR SUB_FLASH_TM FLASH_TM_XVONVEP	
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_FN_QCHI_ERAS 	Z<ZH	XC<D1C YC<D2C
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START FN_ENDURANCE_SCR_INTERNAL
	JSR SUB_FLASH_FN_QCHI_ERAS 	Z<ZH	XC<D1C YC<D2C
	STPS
START FN_CHIP_ERAS_X50
	JSR SUB_FLASH_FN_CHIP_ERAS 	Z<ZH	XC<D1C YC<D2C
	JNI5 .-1
	STPS
START FLASH40_FN_NORL_PROG_1ST_COL 
	NOP	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 
	NOP	XS<XC
	JSR SUB_FLASH_FN_NORL_PROG
	NOP XC<XS
	JNC1 .+2
	JNI1 .-4	XC<XC+D1B				
	STPS
START VREAD_SECT_ERAS_RETRY
	JSR SUB_FLASH_FN_SRVD_ERAS	Z<ZH   XC<D1C YC<D2C	
	JSR SUB_FLASH_BI_SREAD_NORL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE	 
	STPS

;;--*************************************************************************************************	
;;--*************************************************************************************************	
;;--part 6 :normal function

;;-- function
START FN_CHIP_ERAS
	JSR SUB_FLASH_FN_CHIP_ERAS 	Z<ZH	XC<D1C YC<D2C
	STPS
START FN_CHIP_ERAS_ICC
	JSR SUB_FLASH_FN_CHIP_ERAS 	Z<ZH	XC<D1C YC<D2C
	JMP .-1 
	STPS
START FN_SECT_ERAS
	NOP						 	Z<ZH	XC<D1C YC<D2C  
	JSR SUB_FLASH_FN_SECT_ERAS 
	JNC1 .+2												;cflag1~16, if cflag=1, jump tp .+2, else go next.
	JNI1 .-2							XC<XC+D1B
	STPS
START FN_NORL_PROG_UBM_UBM
	NOP						Z<ZH	 UBM_CLR	YC<D2C
	JSR SUB_FLASH_FN_NORL_PROG_UBM_UBM		
	JNC1 .+2
	JNI1 .-2
	STPS
START FN_NORL_READ
	NOP							Z<ZH	XC<D1C YC<D2C  TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_NORL_READ 
	JNC1 .+2
	JNI1 .-2							XC<XC+D1B
	STPS
START FN_NORL_READ_UBM
	NOP						Z<ZH	 UBM_CLR		XC<D1C YC<D2C
	JSR	SUB_FLASH_FN_NORL_READ_UBM		
	JNC1 .+2
	JNI1 .-2						XC<XC+D1B
	STPS
START FN_NORL_READ_UBM_UBM
	NOP						Z<ZH	 UBM_CLR
	JSR	SUB_FLASH_FN_NORL_READ_UBM_UBM			 
	JNC1 .+2
	JNI1 .-2
	STPS
START FN_NORL_READ_UBM_MMA
	NOP						Z<ZH	 UBM_CLR	TP1<TPH1 TP2<TPH2
	JSR	SUB_FLASH_FN_NORL_READ_UBM_MMA			
	JNC1 .+2
	JNI1 .-2						XC<XC+1		;for FCM addr
	NOP AFMXFER
	JBF .
	STPS
START FN_NORL_READ_ADDR_UBM
	NOP						Z<ZH	 UBM_CLR	TP1<TPH1 TP2<TPH2
	JSR	SUB_FLASH_FN_NORL_READ_ADDR_UBM			 
	JNC1 .+2
	JNI1 .-2
	STPS
START FN_SLOW_READ_UBM
	NOP						Z<ZH	 UBM_CLR		XC<D1C YC<D2C
	JSR	SUB_FLASH_FN_SLOW_READ_UBM		
	JNC1 .+2
	JNI1 .-2						XC<XC+D1B
	STPS
START FN_SLOW_READ_UBM_UBM
	NOP						Z<ZH	 UBM_CLR
	JSR	SUB_FLASH_FN_SLOW_READ_UBM_UBM			 
	JNC1 .+2
	JNI1 .-2
	STPS
START FN_SLOW_READ_UBM_MMA
	NOP						Z<ZH	 UBM_CLR	TP1<TPH1 TP2<TPH2
	JSR	SUB_FLASH_FN_SLOW_READ_UBM_MMA			 	
	JNC1 .+2
	JNI1 .-2						XC<XC+1		;for FCM addr
	NOP AFMXFER
	JBF .
	STPS
START FN_SLOW_READ_ADDR_UBM
	NOP						Z<ZH	 UBM_CLR	TP1<TPH1 TP2<TPH2
	JSR	SUB_FLASH_FN_SLOW_READ_ADDR_UBM			 	
	JNC1 .+2
	JNI1 .-2
	STPS

;;-- bist
START BI_CPROG_NORL_ALL
	JSR SUB_FLASH_BI_CPROG_NORL_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CPROG_NORL_NVR
	JSR SUB_FLASH_BI_CPROG_NORL_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CPROG_NORL_ALL_ICC
	JSR SUB_FLASH_BI_CPROG_NORL_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JMP .-2
	STPS
START BI_CPROG_CKBD_ALL
	JSR SUB_FLASH_BI_CPROG_CKBD_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CPROG_CKBD_NVR
	JSR SUB_FLASH_SH_ADDRS_01		Z<ZH
	JSR SUB_FLASH_BI_CPROG_CKBD_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CPROG_DIAG_ALL
	JSR SUB_FLASH_BI_CPROG_DIAG_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2	
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CREAD_NORL_ALL
	JSR SUB_FLASH_BI_CREAD_NORL_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CREAD_NORL_NVR
	JSR SUB_FLASH_BI_CREAD_NORL_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CREAD_CKBD_ALL
	JSR SUB_FLASH_BI_CREAD_CKBD_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CREAD_CKBD_NVR
	JSR SUB_FLASH_BI_CREAD_CKBD_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CREAD_CKBD_ALL_ICC
	JSR SUB_FLASH_BI_CREAD_CKBD_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JMP .-1
	STPS
START BI_CREAD_DIAG_ALL
	JSR SUB_FLASH_BI_CREAD_DIAG_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CSLRD_CKBD_ALL
	JSR SUB_FLASH_BI_CSLRD_CKBD_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_CSLRD_CKBD_NVR
	JSR SUB_FLASH_BI_CSLRD_CKBD_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_SPROG_NORL
	JSR SUB_FLASH_BI_SPROG_NORL      	 Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2	
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_SPROG_CKBD
	JSR SUB_FLASH_BI_SPROG_CKBD		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_SPPRO_NORL
	JSR SUB_FLASH_BI_SPPRO_NORL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_SREAD_NORL
	JSR SUB_FLASH_BI_SREAD_NORL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_SREAD_CKBD
	JSR SUB_FLASH_BI_SREAD_CKBD		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_SSLRD_NORL
	JSR SUB_FLASH_SH_RECAL_01
	JSR SUB_FLASH_BI_SSLRD_NORL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_SH_RECAL_00
	STPS
START BI_SSLRD_CKBD
	JSR SUB_FLASH_BI_SSLRD_CKBD		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS
START BI_RPROG_NORL
	NOP	Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_BI_RPROG_NORL	TP1<TPH1  TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JNC1 .+2
	JNI1 .-3	XC<XC+D1B	
	STPS
START BI_RREAD_NORL
	JSR SUB_FLASH_BI_RREAD_NORL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_BREG_READ_DONE
	STPS

;;-- margin
START MARGIN1_BI_CSLRD_NORL
	JSR SUB_FLASH_TM FLASH_TM_MRG1		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_NORL_ALL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MARGIN1_BI_CSLRD_NORL_NVR
	JSR SUB_FLASH_TM FLASH_TM_MRG1	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_NORL_NVR
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MARGIN1_BI_CSLRD_CKBD
	JSR SUB_FLASH_TM FLASH_TM_MRG1		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_CKBD_ALL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MARGIN1_BI_CSLRD_CKBD_NVR
	JSR SUB_FLASH_TM FLASH_TM_MRG1		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_CKBD_NVR
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MARGIN1_HT_BI_CSLRD_NORL
	JSR SUB_FLASH_TM FLASH_TM_MRG1		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TM FLASH_TM_MRG1_HT		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_NORL_ALL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MARGIN1_HT_BI_CSLRD_NORL_NVR
	JSR SUB_FLASH_TM FLASH_TM_MRG1	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TM FLASH_TM_MRG1_HT		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_NORL_NVR
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MARGIN1_HT_BI_CSLRD_CKBD
	JSR SUB_FLASH_TM FLASH_TM_MRG1		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TM FLASH_TM_MRG1_HT		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_CKBD_ALL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MARGIN1_HT_BI_CSLRD_CKBD_NVR
	JSR SUB_FLASH_TM FLASH_TM_MRG1		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TM FLASH_TM_MRG1_HT		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_CKBD_NVR
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MARGIN0_BI_CSLRD_CKBD
	JSR SUB_FLASH_TM FLASH_TM_MRG0		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_CKBD_ALL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START MARGIN0_BI_CSLRD_CKBD_NVR
	JSR SUB_FLASH_TM FLASH_TM_MRG0		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_CSLRD_CKBD_NVR
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS

;;-- special for RDN, need to be substituted and deleted
START RDN_MARGIN1_BI_SSLRD_NORL
	JSR SUB_FLASH_TM FLASH_TM_MRG1	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_SSLRD_NORL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JNC1 .+2
	JNI1 .-3	YC<YC*2
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS
START RDN_MARGIN1_BI_SSLRD_CKBD
	JSR SUB_FLASH_TM FLASH_TM_MRG1	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_SSLRD_CKBD
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JNC1 .+2
	JNI1 .-3	YC<YC*2
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START RDN_MARGIN1_HT_BI_SSLRD_NORL
	JSR SUB_FLASH_TM FLASH_TM_MRG1	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TM FLASH_TM_MRG1_HT		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_SSLRD_NORL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JNC1 .+2
	JNI1 .-3	YC<YC*2
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START RDN_MARGIN1_HT_BI_SSLRD_CKBD
	JSR SUB_FLASH_TM FLASH_TM_MRG1	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TM FLASH_TM_MRG1_HT		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_SSLRD_CKBD
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JNC1 .+2
	JNI1 .-3	YC<YC*2
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS
START RDN_MARGIN0_BI_SSLRD_CKBD
	JSR SUB_FLASH_TM FLASH_TM_MRG0	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_BI_SSLRD_CKBD 
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JNC1 .+2
	JNI1 .-3	YC<YC*2
	JSR SUB_FLASH_TMEXT 
	JSR SUB_FLASH_TMNXT
	STPS

;;--*************************************************************************************************	
;;--*************************************************************************************************	
;;--part 7 :special only for AUTO EFA

START MARGIN0
	JSR SUB_FLASH_TM FLASH_TM_MRG0	Z<ZH
    	JSR SUB_FLASH_TM FLASH_TM_NOATD
	JSR SUB_FLASH_TMENT
	STPS
START MARGIN1
	JSR SUB_FLASH_TM FLASH_TM_MRG1	Z<ZH
    	JSR SUB_FLASH_TM FLASH_TM_NOATD
	JSR SUB_FLASH_TMENT
	STPS
START MARGIN1_HT
	JSR SUB_FLASH_TM FLASH_TM_MRG1	Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_MRG1_HT
    	JSR SUB_FLASH_TM FLASH_TM_NOATD
	JSR SUB_FLASH_TMENT
	STPS
START MARGIN0_CG3P5V
    JSR SUB_FLASH_TM FLASH_TM_MRG0       Z<ZH
    JSR SUB_FLASH_TM FLASH_TM_EXCGB
    JSR SUB_FLASH_TM FLASH_TM_NOATD
    JSR SUB_FLASH_TMENT
	STPS
START CELL_CURRENT_MODE
	JSR SUB_FLASH_TM FLASH_TM_VTON	Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_NOATD
	JSR SUB_FLASH_TMENT
	STPS
START CG3P5V_CELL_CURRENT_MODE
	JSR SUB_FLASH_TM FLASH_TM_EXCGB  Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_VTON
	JSR SUB_FLASH_TM FLASH_TM_NOATD
	JSR SUB_FLASH_TMENT
	STPS
START EFA_BI_CREAD_DIAG_ALL
	JSR SUB_FLASH_BI_CLEAR_FAIL 		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_BI_CREAD_DIAG_ALL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_FN_BFRE_READ_MMA
	NOP AFMXFER
	JBF .
	STPS
START EFA_BI_CSLRD_NORL_ALL
	JSR SUB_FLASH_BI_CLEAR_FAIL 		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_BI_CSLRD_NORL_ALL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_FN_BFRE_READ_MMA
	NOP AFMXFER
	JBF .
	STPS
START EFA_BI_CSLRD_CKBD_ALL
	JSR SUB_FLASH_BI_CLEAR_FAIL 		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_BI_CSLRD_CKBD_ALL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_FN_BFRE_READ_MMA
	NOP AFMXFER
	JBF .
	STPS
START EFA_BI_SSLRD_NORL
	JSR SUB_FLASH_BI_CLEAR_FAIL 		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_BI_SSLRD_NORL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_FN_BFRE_READ_MMA
	NOP AFMXFER
	JBF .
	STPS
START EFA_BI_SSLRD_CKBD
	JSR SUB_FLASH_BI_CLEAR_FAIL 		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_BI_SSLRD_CKBD 
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_FN_BFRE_READ_MMA
	NOP AFMXFER
	JBF .
	STPS
START EFA_BI_RSLRD_NORL
	JSR SUB_FLASH_BI_CLEAR_FAIL 		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_BI_RSLRD_NORL
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_FN_BFRE_READ_MMA
	NOP AFMXFER
	JBF .
	STPS
START EFA_BI_RSLRD_CKBD
	JSR SUB_FLASH_BI_CLEAR_FAIL 		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_BI_RSLRD_CKBD
	JSR SUB_FLASH_FN_BREG_READ_DONE
	JSR SUB_FLASH_FN_BFRE_READ_MMA
	NOP AFMXFER
	JBF .
	STPS
START EFA_FLASH_FN_SLOW_READ
	STPS
START EFA_CELL_CURRENT
	JSR SUB_FLASH_TM FLASH_TM_VTON	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 
	JSR SUB_FLASH_TM FLASH_TM_NOATD
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_FN_SEND_ADDA 
	JSR SUB_FLASH_FN_NORL_READ
	STPS
START EFA_CELL_CURRENT_MODEONCE
	JSR SUB_FLASH_FN_SEND_ADDA    Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 
	JSR SUB_FLASH_FN_NORL_READ
	STPS

;;--*************************************************************************************************	
;;--*************************************************************************************************	
;;--part 8 :special only for debug testblock

START FN_NORL_PROG
	NOP Z<ZH
	JSR SUB_FLASH_FN_NORL_PROG XC<D1C YC<D2C TP1<TPH1	 
	STPS
START FN_NORL_PROG_DEBUG
	NOP Z<1
	JSR SUB_FLASH_FN_NORL_PROG XC<D1C YC<D2C TP1<TPH1	 
	STPS
START FN_NORL_PROG_ALL_64
	NOP Z<ZH   XC<D1C YC<D2C TP1<TPH1	 
    NOP  D1A<#800000
	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
	JSR SUB_FLASH_FN_NORL_PROG 
	NOP Z<ZH   XC<XC-D1A YC<D2C TP1<TPH1	 
    NOP D1A<#400000
	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
	JSR SUB_FLASH_FN_NORL_PROG 
	NOP Z<ZH   XC<XC-D1A YC<D2C TP1<TPH1	 
	JNC1 .+2
	JNI1 .-9	XC<XC+D1B
	STPS
START FN_NORL_PROG_CKBD
	NOP Z<ZH   XC<D1C YC<D2C TP1<TPH1	 
	JSR SUB_FLASH_FN_NORL_PROG 
	NOP Z<ZH   XC<XC+1 TP1<TPH1B	 
	JSR SUB_FLASH_FN_NORL_PROG 
	NOP XC<XC-1 	 
	JNC1 .+2
	JNI1 .-5	XC<XC+D1B  TP1<TPH1
	STPS
START FN_NORL_READ_FCM
	NOP							Z<ZH	XC<D1C YC<D2C  TP1<TPH1 TP2<TPH2
LP:	JSR SUB_FLASH_FN_NORL_READ_MMA
	JNI1 LP								XC<XC+D1B
	NOP	AFMXFER
	JBF .
	JNC2 .+2
	JNI2 LP							
	STPS
START CELL_CURRENT
	JSR SUB_FLASH_TM FLASH_TM_VTON	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 
	JSR SUB_FLASH_TM FLASH_TM_NOATD
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_FN_SEND_ADDA 
	JSR SUB_FLASH_FN_NORL_READ
	JMP . IDLE 
	STPS
START CELL_CURRENT_SET
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_FN_SEND_ADDA   Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_NORL_READ
	JMP . IDLE
	STPS
START REF_CURRENT_M0
	JSR SUB_FLASH_TM FLASH_TM_RVTON	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 
	JSR SUB_FLASH_TM FLASH_TM_NOATD
	JSR SUB_FLASH_TM FLASH_TM_TRM_RD	Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_MRG0   ;M0: 00, M1: 11
	NOP D1A<#0      D2A<#0   TP2<TPH2B
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C	TP2<TPH2	;need scan B[4:0]	CBD6
	NOP D1A<#007F3  D2A<#00  
	JSR SUB_FLASH_FN_SLOW_READ_WO_CPE XC<D1A YC<D2A TP1<#0 TP2<#0
	JSR SUB_FLASH_SH_COUNT_00   Z<ZH	
	JMP . IDLE 
	STPS
START REF_CURRENT_M1
	JSR SUB_FLASH_TM FLASH_TM_RVTON	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 
	JSR SUB_FLASH_TM FLASH_TM_NOATD
	JSR SUB_FLASH_TM FLASH_TM_TRM_RD	Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_MRG1   ;M0: 00, M1: 11
	NOP D1A<#0      D2A<#0   TP2<TPH2B
	JSR SUB_FLASH_TMENT
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C	TP2<TPH2	;need scan B[4:0]	CBD6
	NOP D1A<#007F3  D2A<#00  
	JSR SUB_FLASH_FN_SLOW_READ_WO_CPE XC<D1A YC<D2A TP1<#0 TP2<#0
	JSR SUB_FLASH_SH_COUNT_00   Z<ZH	
	JMP . IDLE 
	STPS

;;--*************************************************************************************************	
;;--*************************************************************************************************	
;;--part 9:other temps
START NVR_READ_VCODE_TCODE_CP3
;	JSR SUB_FLASH_SH_CFGLK_00
;	JSR SUB_FLASH_SH_RECAL_01
	NOP D1A<#800180 Z<ZH    AREA_N UBM_ENB UBM_CLR ;Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A
	NOP D1A<#8001C0  AREA_N 
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A
	NOP D1A<#8001C1  AREA_N                       ;Vcode=0000,0001,0010 Tcode=1000
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001C2  AREA_N                       ;Vcode=0110,0111,1000 Tcode=1000
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001C3  AREA_N                       ;Vcode=1100,1101,1110 Tcode=1000
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001C4  AREA_N                       ;Tcode=0010,0011,0100 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001C5  AREA_N                       ;Tcode=1000,1001,1010 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001C6  AREA_N                       ;Tcode=1110,1111 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001C7  AREA_N                       ;Tcode=1110,1111 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001C8  AREA_N                       ;Tcode=1110,1111 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001C9  AREA_N                       ;Tcode=1110,1111 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001CA  AREA_N                       ;Tcode=1110,1111 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001CB  AREA_N                       ;Tcode=1110,1111 Vcode=Vcode_trim
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#8001CC
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#800120
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#800121
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#800122
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#800123
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
	NOP D1A<#800124
	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#8001A2
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#8001A3
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#8001AC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	JSR SUB_FLASH_SH_RECAL_00
	STPS

START NVR_CFG_PROG_TRIM_40_UBM
	NOP D1A<#807FC0	Z<ZH	AREA_NC	 
        NOP UBM_CLR  UBM_ENB
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#807FC1	Z<ZH	AREA_NC	 
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#807F80	Z<ZH	AREA_NC	 
        NOP UBM_CLR  UBM_ENB
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
	NOP D1A<#807F81	Z<ZH	AREA_NC	 
	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	JSR SUB_FLASH_SH_CFGLK_00  Z<ZH	
;	NOP D1A<#81FFF8	Z<ZH	AREA_NC	 UBM_CLR
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFF9   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFA   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFB   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFC   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFD   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFE   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFF  AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#800180  AREA_NC    ;write id info
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#400180  AREA_NC    ;write id info
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#800181  AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#400181  AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFF4  AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A  TP1<#7654 
;	NOP D1A<#81FF78		AREA_NC				 UBM_CLR
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FF79   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FF7A   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FF7B   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FF7C	 AREA_NC 
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FF7D   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FF7E   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FF7F   AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#800100  AREA_NC    ;write id info
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#400100  AREA_NC    ;write id info
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#800101  AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#400101  AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FF74  AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A  TP1<#7654 
;	JSR SUB_FLASH_SH_CFGLK_01
	STPS
;START NVR_CFG_READ_TRIM_40
;	NOP D1A<#81FFF8	Z<ZH	AREA_NC	 UBM_CLR
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFF9		AREA_NC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFA     AREA_NC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFB     AREA_NC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFC    AREA_NC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFD    AREA_NC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFE   AREA_NC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFFF    AREA_NC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#100  AREA_NC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#101  AREA_NC
;	JSR SUB_FLASH_FN_SLOW_READ_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFF4  AREA_NC    	
;	JSR SUB_FLASH_FN_SLOW_READ XC<D1A YC<D2A     TP1<#FFFFFFFF TP2<#7654
;	STPS
;START NVR_CFG_PRO_REPAIRED_ROWS_UBM
;	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH 
;	JSR SUB_FLASH_SH_CFGLK_00
;	NOP D1A<#8FFFF6	AREA_NC  UBM_CLR 
;	JSR SUB_FLASH_FN_NORL_PROG_UBM  XC<D1A YC<D2A 
;	NOP D1A<#8FFFF7	AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FFF5	AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#8FFF76	AREA_NC  UBM_CLR 
;	JSR SUB_FLASH_FN_NORL_PROG_UBM  XC<D1A YC<D2A 
;	NOP D1A<#8FFF77	AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	NOP D1A<#81FF75	AREA_NC
;	JSR SUB_FLASH_FN_NORL_PROG_UBM XC<D1A YC<D2A 
;	STPS
;;START NVR_CFG_READ_REPAIRED_ROWS_MMA
;	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH 
;	JSR SUB_FLASH_SH_CFGLK_01
;	JSR SUB_FLASH_SH_RECAL_01
;	NOP D1A<#8FFFF6	AREA_NC  UBM_CLR 
;	JSR SUB_FLASH_FN_SLOW_READ_MMA XC<D1A YC<D2A 
;	NOP D1A<#8FFFF7	AREA_NC  
;	JSR SUB_FLASH_FN_SLOW_READ_MMA XC<D1A YC<D2A 
;	NOP D1A<#81FFF5	AREA_NC  
;	JSR SUB_FLASH_FN_SLOW_READ_MMA XC<D1A YC<D2A 
;	STPS
;




















;;;--- START MARGIN0_BI_CSLRD_CKBD_NVR_CG3P5
;;;--- ;	JSR SUB_FLASH_SH_ADDRS_01
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_MRG0		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_EXCGB		;only for 40EF
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_BI_CSLRD_CKBD_NVR
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	JSR SUB_FLASH_TMEXT 
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START MARGIN0_BI_CSLRD_CKBD_CG3P5
;;;--- 	;JSR SUB_FLASH_SH_ADDRS_01	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_MRG0		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_EXCGB		;only for 40EF
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_BI_CSLRD_CKBD_ALL
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	JSR SUB_FLASH_TMEXT 
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START MARGIN0_BI_CSLRD_NORL
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_MRG0		Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_BI_CSLRD_NORL_ALL
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	JSR SUB_FLASH_TMEXT 
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START MARGIN0_BI_CSLRD_NORL_NVR
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_MRG0	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_BI_CSLRD_NORL_NVR
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	JSR SUB_FLASH_TMEXT 
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START RDN_MARGIN0_BI_SSLRD_NORL
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_MRG0	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
;;;--- ;	JSR SUB_FLASH_TM FLASH_TM_MRG1_HT		;only for 40EF
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_BI_SSLRD_NORL
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	JNC1 .+2
;;;--- 	JNI1 .-3	YC<YC*2
;;;--- 	JSR SUB_FLASH_TMEXT 
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START RDN_MARGIN0_BI_SSLRD_CKBD_CG3P5
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_MRG0	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_EXCGB		;only for 40EF
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_NOATD		;only for 40EF
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- ;	IDXI6 10000 IDLE
;;;--- 	JSR SUB_FLASH_BI_SSLRD_CKBD 
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	JNC1 .+2
;;;--- 	JNI1 .-3	YC<YC*2
;;;--- 	JSR SUB_FLASH_TMEXT 
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START BI_BREG_READ_DONE
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE		Z<ZH	
;;;--- 	STPS
;;;--- START BI_RPROG_CKBD
;;;--- 	JSR SUB_FLASH_BI_RPROG_CKBD		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_RREAD_CKBD
;;;--- 	JSR SUB_FLASH_BI_RREAD_CKBD		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_RSLRD_NORL
;;;--- 	JSR SUB_FLASH_BI_RSLRD_NORL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_RSLRD_CKBD
;;;--- 	JSR SUB_FLASH_BI_RSLRD_CKBD		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START READ_2_8ROWS00	;need debug 
;;;--- 	NOP		Z<ZH XC<D1C YC<D2C TP1<0 TP2<0
;;;--- 	JSR SUB_FLASH_BI_RSLRD_NORL        TP1<0 TP2<0
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	JNC1 .+2
;;;--- 	JNI1 .-3						XC<XC+D1B
;;;--- 	STPS
;;;--- START FN_NORL_PROG_1ST_COL
;;;--- 	NOP	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	JNC1 .+2
;;;--- 	JNI1 .-2	XC<XC+D1B				
;;;--- 	STPS
;;;--- START RTST_STRESS
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_NWLNV	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_MEO
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_SH_COUNT_00
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	;stress 80-100ms
;;;--- 	JSR SUB_FLASH_SH_COUNT_01
;;;--- 	JSR SUB_FLASH_TMEXT	
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START NVR_CFG_RD_ID
;;;--- 	JSR SUB_FLASH_SH_RECAL_01  Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR	SUB_FLASH_FN_SLOW_READ; Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_SH_RECAL_00
;;;--- 	STPS
;;;--- START CHIP_ERAS_VEG_TRIM
;;;--- 	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_DIVMEAS_XVONVEP2	Z<ZH 	;110 TM_05
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_SH_COUNT_00
;;;--- 	JSR SUB_FLASH_FN_CHIP_ERAS XC<0 YC<0		;need Measure VEG 
;;;--- 	JMP . IDLE 
;;;--- 	STPS
;;;--- START HV_TRIM_EXIT
;;;--- 	JSR SUB_FLASH_SH_COUNT_01	Z<ZH
;;;--- 	JSR SUB_FLASH_TMEXT
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START TMODE_IN_OUT
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_DIVMEAS_XVONVEP2	Z<ZH	;110 TM_05
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_SH_COUNT_00
;;;---     	IDXI6  3000 IDLE
;;;--- 	JSR SUB_FLASH_SH_COUNT_01_ERASE	
;;;--- 	JSR SUB_FLASH_TMEXT
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START MEAS_VEG_CHIP_ERASE
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_DIVMEAS_XVONVEP2	Z<ZH	;110 TM_05
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_SH_COUNT_00
;;;--- 	JSR SUB_FLASH_FN_CHIP_ERAS XC<0		;need Measure VEG 	
;;;--- 	JMP . IDLE 
;;;--- 	STPS
;;;--- START PROG_VSL_TRIM
;;;--- 	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_XVONSL	Z<ZH	;110 TM_10
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
;;;--- 	JSR SUB_FLASH_SH_COUNT_00
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<0 YC<0 TP1<#FFFFFFFF	
;;;--- 	JMP . IDLE 
;;;--- 	STPS
;;;--- START PROG_VCG_TRIM
;;;--- 	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C TP1<TPH1 TP2<TPH2 Z<ZH
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_DIVMEAS_XVONVEP2	Z<ZH	;110 TM_05
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_SH_COUNT_00
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<0 YC<0 TP1<#FFFFFFFF
;;;--- 	JMP . IDLE 
;;;--- 	STPS
;;;--- START NVR_CFG_PROG_TRIM_40
;;;--- ;	JSR SUB_FLASH_SH_CFGLK_00
;;;--- ;	NOP D1A<#807FF1	Z<ZH	UBM_ENB UBM_CLR
;;;--- 	NOP D1A<#81FFF8	Z<ZH	AREA_NC	;UBM_ENB UBM_CLR
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FFF8	Z<ZH	
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FF3    ; 110
;;;--- 	NOP D1A<#81FFF9   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FFF9   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FF5;110
;;;--- 	NOP D1A<#81FFFA   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FFFA   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FF7 ;110
;;;--- 	NOP D1A<#81FFFB   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FFFB   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FF9
;;;--- 	NOP D1A<#81FFFC   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FFFC   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FFB
;;;--- 	NOP D1A<#81FFFD   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FFFD   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FFD
;;;--- 	NOP D1A<#81FFFE   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FFFE   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#81FFFF  AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FFFF  AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 
;;;--- 	NOP D1A<#800000  AREA_NC    ;write id info
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#400000  AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#800001  AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#400001  AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 
;;;--- ;	NOP D1A<#807FB1						UBM_ENB UBM_CLR
;;;--- 	NOP D1A<#81FF78		AREA_NC		;		UBM_ENB UBM_CLR
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FF78		AREA_NC				
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FB3
;;;--- 	NOP D1A<#81FF79   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FF79   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FB5
;;;--- 	NOP D1A<#81FF7A   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FF7A   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FB7
;;;--- 	NOP D1A<#81FF7B   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FF7B   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FB9
;;;--- 	NOP D1A<#81FF7C	 AREA_NC 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FF7C	 AREA_NC 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FBB
;;;--- 	NOP D1A<#81FF7D   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FF7D   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FBD
;;;--- 	NOP D1A<#81FF7E   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FF7E   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- ;	NOP D1A<#807FBF
;;;--- 	NOP D1A<#81FF7F   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#41FF7F   AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 
;;;--- 	NOP D1A<#800080  AREA_NC    ;write id info
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#400080  AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#800081  AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 	NOP D1A<#400081  AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A 
;;;--- 
;;;--- 
;;;--- ;	JSR SUB_FLASH_SH_CFGLK_01
;;;--- 	STPS
;;;--- START NVR_CFG_PRO_REPAIRED_ROWS
;;;--- 	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH 
;;;--- 	JSR SUB_FLASH_SH_CFGLK_00
;;;--- 	NOP D1A<#8FFFF6	AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG  XC<D1A YC<D2A TP1<TPH1A TP2<TPH2A
;;;--- 	NOP D1A<#8FFF76	AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A TP1<TPH1A TP2<TPH2A
;;;--- 	NOP D1A<#8FFFF7	AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG  XC<D1A YC<D2A TP1<TPH1B TP2<TPH2B
;;;--- 	NOP D1A<#8FFF77	AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A TP1<TPH1B TP2<TPH2B
;;;--- 	STPS
;;;--- START NVR_CFG_PRO_REPAIRED_ROWS_01
;;;--- 	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH 
;;;--- 	JSR SUB_FLASH_SH_CFGLK_00
;;;--- 	NOP D1A<#8FFFF7	AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG  XC<D1A YC<D2A TP1<TPH1B TP2<TPH2B
;;;--- 	NOP D1A<#8FFF77	AREA_NC
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG XC<D1A YC<D2A TP1<TPH1B TP2<TPH2B
;;;--- 	STPS
;;;--- START NVR_CFG_READ_REPAIRED_ROWS
;;;--- 	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH 
;;;--- ;	JSR SUB_FLASH_SH_CFGLK_01
;;;--- 	JSR SUB_FLASH_SH_RECAL_01
;;;--- 	NOP D1A<#8FFFF6	AREA_NC
;;;--- 	JSR SUB_FLASH_FN_SLOW_READ XC<D1A YC<D2A TP1<TPH1A TP2<TPH2A
;;;--- 	NOP D1A<#8FFFF7	AREA_NC
;;;--- 	JSR SUB_FLASH_FN_SLOW_READ XC<D1A YC<D2A TP1<TPH1B TP2<TPH2B
;;;--- 	STPS
;;;--- 
;;;--- START NVR_CFG_READ_REPAIRED_ROWS_2
;;;--- 	JSR SUB_FLASH_SH_ADDRS_00	Z<ZH 
;;;--- ;	JSR SUB_FLASH_SH_CFGLK_01
;;;--- ;	JSR SUB_FLASH_SH_RECAL_01
;;;--- ;	NOP D1A<#8FFFF6	AREA_NC
;;;--- ;	JSR SUB_FLASH_FN_SLOW_READ XC<D1A YC<D2A TP1<TPH1A TP2<TPH2A
;;;--- ;	JSR SUB_FLASH_SH_RECAL_01
;;;--- 	NOP D1A<#8FFFF7	AREA_NC
;;;--- 	JSR SUB_FLASH_FN_SLOW_READ XC<D1A YC<D2A TP1<TPH1B TP2<TPH2B
;;;--- 	STPS
;;;--- START FN_NORL_PROG_ONE_ADDR_64
;;;--- 	NOP Z<ZH   XC<D1C YC<D2C TP1<TPH1	 
;;;---     NOP  D1A<#800000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	NOP Z<ZH   XC<XC-D1A YC<D2C TP1<TPH1	 
;;;---     NOP D1A<#400000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	NOP Z<ZH   XC<XC-D1A YC<D2C TP1<TPH1	 
;;;--- 	STPS
;;;--- START FN_NORL_PROG_ALL
;;;--- 	NOP Z<ZH   XC<D1C YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	JNC1 .+2
;;;--- 	JNI1 .-2	XC<XC+D1B
;;;--- 	STPS
;;;--- START FN_NORL_RPROG_CKBD_64
;;;--- ;	STI2 510	
;;;--- 	NOP Z<ZH   XC<D1C YC<D2C TP1<TPH1	 
;;;--- PRO_START_ALL:@
;;;---     NOP  D1A<#800000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	NOP Z<ZH   XC<XC-D1A YC<D2C TP1<TPH1	 
;;;---     NOP D1A<#400000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;---     NOP XC<XC-D1A 
;;;--- 	JNI1 .-8	XC<XC+D1B
;;;--- 	NOP XC<XC+1
;;;---     NOP  D1A<#800000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	NOP Z<ZH   XC<XC-D1A YC<D2C TP1<TPH1	 
;;;---     NOP D1A<#400000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;---     NOP XC<XC-D1A 
;;;--- 	JNI1 .-8	XC<XC+D1B 
;;;--- 	JNI2 PRO_START_ALL	XC<XC-1 
;;;--- 	STPS
;;;--- START FN_NORL_RPROG_CKBD
;;;--- 	STI2 510	
;;;--- 	NOP Z<ZH   XC<D1C YC<D2C TP1<TPH1	 D1A<#80
;;;--- PRO_START:@
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	JNI1 .-1	XC<XC+D1B
;;;--- 	NOP XC<XC+1
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	JNI1 .-1	XC<XC+D1B 
;;;--- 	JNI2 PRO_START	XC<XC-1 
;;;--- 	STPS
;;;--- START FN_NORL_RPROG_ICKBD_64
;;;--- ;	STI2 510	
;;;--- 	NOP Z<ZH   XC<D1C YC<D2C TP1<TPH1	 
;;;--- 	NOP XC<XC+1
;;;--- PRO_ISTART_ALL:@
;;;---     NOP  D1A<#800000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	NOP Z<ZH   XC<XC-D1A YC<D2C TP1<TPH1	 
;;;---     NOP D1A<#400000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;---     NOP XC<XC-D1A 
;;;--- 	JNI1 .-8	XC<XC+D1B
;;;--- 	NOP XC<XC-1
;;;---     NOP  D1A<#800000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	NOP Z<ZH   XC<XC-D1A YC<D2C TP1<TPH1	 
;;;---     NOP D1A<#400000
;;;--- 	NOP Z<ZH   XC<XC+D1A YC<D2C TP1<TPH1	 
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;---     NOP XC<XC-D1A 
;;;--- 	JNI1 .-8	XC<XC+D1B 
;;;--- 	JNI2 PRO_ISTART_ALL	XC<XC+1 
;;;--- 	STPS
;;;--- START FN_NORL_RPROG_ICKBD
;;;--- 	STI2 510	
;;;--- 	NOP Z<ZH   XC<D1C YC<D2C TP1<TPH1	 D1A<#80	
;;;--- 	NOP XC<XC+1
;;;--- PRO_ISTART:@
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	JNI1 .-1	XC<XC+D1B
;;;--- 	NOP XC<XC-1
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG 
;;;--- 	JNI1 .-1	XC<XC+D1B 
;;;--- 	JNI2 PRO_ISTART XC<XC+1	
;;;--- 	STPS
;;;--- START FN_QCHI_ERAS
;;;--- 	JSR SUB_FLASH_FN_QCHI_ERAS 	Z<ZH	XC<D1C YC<D2C
;;;--- 	STPS
;;;--- START MPT_STRESS
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_NWLNV	Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_MEO
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_SL0V
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_EXCGB
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_30
;;;--- 	JSR SUB_FLASH_TM FLASH_TM_EXARGND
;;;--- 	JSR SUB_FLASH_TMENT
;;;--- 	JSR SUB_FLASH_SH_COUNT_00
;;;--- 	JSR SUB_FLASH_FN_NORL_PROG
;;;--- 	JSR SUB_FLASH_SH_COUNT_01
;;;--- 	JSR SUB_FLASH_TMEXT
;;;--- 	JSR SUB_FLASH_TMNXT
;;;--- 	STPS
;;;--- START FN_SLOW_READ
;;;--- 	NOP							Z<ZH	XC<D1C YC<D2C  TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_SLOW_READ 
;;;--- 	JNC1 .+2
;;;--- 	JNI1 .-2	XC<XC+D1B
;;;--- 	STPS
;;;--- START BI_CPPRO_NORL_ALL
;;;--- 	JSR SUB_FLASH_BI_CPPRO_NORL_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_CPPRO_CKBD_ALL
;;;--- 	JSR SUB_FLASH_BI_CPPRO_CKBD_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_CPPRO_DIAG_ALL
;;;--- 	JSR SUB_FLASH_BI_CPPRO_DIAG_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_MERED_NORL_ALL
;;;--- 	JSR SUB_FLASH_BI_MERED_NORL_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_MORED_NORL_ALL
;;;--- 	JSR SUB_FLASH_BI_MORED_NORL_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_CSLRD_NORL_ALL
;;;--- 	JSR SUB_FLASH_BI_CSLRD_NORL_ALL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_CPROG_DIAG_NVR
;;;--- 	JSR SUB_FLASH_BI_CPROG_DIAG_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_CPPRO_NORL_NVR
;;;--- 	JSR SUB_FLASH_BI_CPPRO_NORL_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_CPPRO_CKBD_NVR
;;;--- 	JSR SUB_FLASH_BI_CPPRO_CKBD_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_CPPRO_DIAG_NVR
;;;--- 	JSR SUB_FLASH_BI_CPPRO_DIAG_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_CREAD_DIAG_NVR
;;;--- 	JSR SUB_FLASH_BI_CREAD_DIAG_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_MERED_NORL_NVR
;;;--- 	JSR SUB_FLASH_BI_MERED_NORL_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_MORED_NORL_NVR
;;;--- 	JSR SUB_FLASH_BI_MORED_NORL_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_CSLRD_NORL_NVR
;;;--- 	JSR SUB_FLASH_BI_CSLRD_NORL_NVR		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_SPPRO_CKBD
;;;--- 	JSR SUB_FLASH_BI_SPPRO_CKBD		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_RPPRO_NORL
;;;--- 	JSR SUB_FLASH_BI_RPPRO_NORL		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
;;;--- START BI_RPPRO_CKBD
;;;--- 	JSR SUB_FLASH_BI_RPPRO_CKBD		Z<ZH	XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
;;;--- 	JSR SUB_FLASH_FN_BREG_READ_DONE
;;;--- 	STPS
START NORM_RD_TRIMX72B;need to check
	JSR SUB_FLASH_TM FLASH_TM_11	
	JSR SUB_FLASH_TMENT
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C	TP2<TPH2
	NOP	D1A<#0 D2A<#0			;init REFSET address CBD0
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFBFC9	;init REFSET
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFF7FC9	;init REFSET
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A  TP2<#FFFFFAFFF  ;	TP2<#FFFFFFFFF	;init REFSET   default 1
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A  TP2<#FFFFF0FFF  ;	TP2<#FFFFFFFFF	;init REFSET   default 1
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C	TP2<TPH2
	NOP	D1A<#1FB3 D2A<#00
;	NOP	D1A<#17F3 D2A<#00
	JSR SUB_FLASH_FN_SLOW_READINX72B XC<D1A YC<D2A TP1<#0 TP2<#0
;	JSR SUB_FLASH_FN_CDAT_READ XC<D1A TP1<#FE
	JSR SUB_FLASH_FN_CDAT_READ XC<D1A TP1<#0
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS


START MRG0_RD_TRIMX72B
	JSR SUB_FLASH_TM FLASH_TM_11	Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_00
	JSR SUB_FLASH_TMENT
	NOP	D1A<#0	D2A<#0		;CBD0
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFFFFC9
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFF7FC9
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFFFFC9
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFFFFF
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C	TP2<TPH2	;need scan B[14:10]
	NOP D1A<#0001FB3  D2A<#00  
;	NOP D1A<#00007F3  D2A<#00  
	JSR SUB_FLASH_FN_SLOW_READIN XC<D1A YC<D2A TP1<#0 TP2<#0
	JSR SUB_FLASH_FN_CDAT_READ XC<D1A TP1<#FE
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS


START MRG1_RD_TRIMX72B;need to check
	JSR SUB_FLASH_TM FLASH_TM_11	Z<ZH
	JSR SUB_FLASH_TM FLASH_TM_01
	JSR SUB_FLASH_TMENT
;	NOP	D1A<#5	D2A<#0		;CBD5
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFFFDFF	;CBD5
	NOP	D1A<#0	D2A<#0		;CBD0
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFFDFC9   ; BFC9 for 60%,FFC9 for 50%;DFC9 : 54%.
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFFBFC9   ; BFC9 for 60%,FFC9 for 50%;DFC9 : 54%.
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFFFFC9	;init REFSET
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A  	TP2<#FFFFFFFC9	;init REFSET   default 1
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C	TP2<TPH2	;need scan B[4:0]	CBD6
	NOP D1A<#01FF3  D2A<#00  
;	NOP D1A<#00FB3  D2A<#00  
	JSR SUB_FLASH_FN_SLOW_READINX72B_10US XC<D1A YC<D2A TP1<#0 TP2<#0
	IDXI6  400 IDLE
	JSR SUB_FLASH_FN_CDAT_READ XC<D1A TP1<#FE
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	STPS


;START VREAD1_TRIM;need to check
;	JSR SUB_FLASH_TM FLASH_TM_11	Z<ZH
;	JSR SUB_FLASH_SH_VREAD_01	Z<ZH 
;	JSR SUB_FLASH_TMENT
;	NOP	D1A<#FFFFF8	D2A<#FF		;CBD0
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP1<#FFFFBFC9
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C	TP1<TPH1 	;need scan B[9:5]
;	NOP D1A<#00007B  D2A<#00  
;	JSR SUB_FLASH_FN_SLOW_READIN XC<D1A YC<D2A TP1<#F7FFF7FF TP2<#FFFFFFFF
;	JSR SUB_FLASH_FN_CDAT_READ XC<D1A TP1<#FE
;	JSR SUB_FLASH_TMEXT
;	JSR SUB_FLASH_TMNXT
;	JSR SUB_FLASH_SH_VREAD_00
;	STPS

START VREAD1_TRIMX72B;need to check
	JSR SUB_FLASH_SH_VREAD_01	Z<ZH 
	JSR SUB_FLASH_TM FLASH_TM_11	Z<ZH
	JSR SUB_FLASH_TMENT
	NOP	D1A<#0	D2A<#0		;CBD0
;	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFFFFF
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1A YC<D2A	TP2<#FFFFF7FC9
	JSR SUB_FLASH_FN_CONF_WRIT XC<D1C YC<D2C	TP2<TPH2 	;need scan B[9:5]
	NOP D1A<#01FB3  D2A<#00  
;	NOP D1A<#007F3  D2A<#00  
	JSR SUB_FLASH_FN_SLOW_READINX72B XC<D1A YC<D2A TP1<#0 TP2<#0
	JSR SUB_FLASH_FN_CDAT_READ XC<D1A TP1<#FE
	JSR SUB_FLASH_TMEXT
	JSR SUB_FLASH_TMNXT
	JSR SUB_FLASH_SH_VREAD_00
	STPS





START FN_SLOW_READ_FCM_1 
	NOP							Z<ZH	XC<D1C YC<D2C  TP1<TPH1 TP2<TPH2
	JSR SUB_FLASH_FN_SLOW_READ_MMA
	NOP	AFMXFER
	JBF .
	STPS

START NVR_CFG_RD_ID_H32
	JSR SUB_FLASH_SH_RECAL_01  Z<ZH XC<D1C YC<D2C TP1<TPH1 TP2<TPH2
	JSR	SUB_FLASH_FN_SLOW_READ_H32
	JSR SUB_FLASH_SH_RECAL_00
	STPS



#ifdef RATE20MHZ
	%INSERT subpat20mhz
#elif (defined RATE15MHZ)
	%INSERT subpat15mhz
#elif (defined RATE10MHZ)
	%INSERT subpat10mhz
#elif (defined RATE5MHZ)
	%INSERT subpat5mhz
#endif
END
